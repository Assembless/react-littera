{"version":3,"file":"index.js","sources":["../src/core/translate.ts","../src/react/service.tsx","../src/utils/helpers.ts","../src/react/hooks.ts"],"sourcesContent":["import { LitteraTranslated, LitteraTranslations } from '../typings'\r\n\r\n/**\r\n * Reduces a translations object, returning translations for the specified locale.\r\n * @category core\r\n * @param translations The translations object.\r\n * @param locale The locale to return.\r\n */\r\nexport const translate = <T, K extends keyof T>(\r\n  translations: LitteraTranslations<T>,\r\n  locale: string\r\n): LitteraTranslated<T, K> => translations[locale] ?? {}\r\n","import * as React from 'react'\r\nimport { translate } from '../core/translate'\r\nimport { LitteraContextValue, LitteraTranslations } from '../typings'\r\n\r\nexport const LitteraContext = React.createContext<LitteraContextValue<any>>({\r\n  locale: 'en_US',\r\n  locales: ['en_US'],\r\n  setLocale: () => {},\r\n  translate: <T, K extends keyof T>(\r\n    translations: LitteraTranslations<T>,\r\n    locale?: string\r\n  ) => translate<T, K>(translations, locale ?? 'en_US')\r\n})\r\n\r\n/**\r\n * Context Provider for Littera\r\n * @category React\r\n * @public\r\n * @param initialLocale Initial active locale.\r\n * @param preset Set of predefined translations.\r\n * @param setLocale Callback called when the locale changes.\r\n * @param pattern Locale pattern.\r\n * @example\r\n * // Setting up Littera provider.\r\n *\r\n * const App = () => {\r\n *    return <LitteraService locales={[\"en_US\", \"de_DE\"]}>\r\n *      ...\r\n *    </LitteraService>\r\n * }\r\n */\r\nexport const LitteraService = function <T extends ReadonlyArray<unknown>>({\r\n  children,\r\n  initialLocale,\r\n  locales\r\n}: {\r\n  children: any\r\n  initialLocale: T[number]\r\n  locales: T\r\n}) {\r\n  const [locale, setLocale] = React.useState(\r\n    initialLocale ?? locales[0] ?? 'en_US'\r\n  )\r\n\r\n  return (\r\n    <LitteraContext.Provider\r\n      value={{ locale, setLocale, locales } as LitteraContextValue<T>}\r\n    >\r\n      {children}\r\n    </LitteraContext.Provider>\r\n  )\r\n}\r\n","/**\r\n * Throws an error if the given locale is not contained in the list of locales.\r\n * @param locales The list of locales.\r\n * @param locale The locale to check.\r\n * @returns True if the locale is contained, throw error otherwise.\r\n */\r\nexport const throwInvalidLocale = (locales: string[], locale: string) => {\r\n  if(!locales.includes(locale)) \r\n    throw new Error(`Invalid locale provided. Expected [${locales.join(\", \")}], got ${locale}`);\r\n\r\n  return true;\r\n}","import * as React from 'react'\r\nimport { LitteraContext } from './service'\r\nimport { translate } from '..'\r\nimport { throwInvalidLocale } from '../utils/helpers'\r\nimport { LitteraTranslated, LitteraTranslations } from '../typings'\r\n\r\n/**\r\n * @description React hook for translating a component.\r\n * @category React\r\n * @param translations\r\n * @param locale Optional locale to translate to. Defaults to the current locale.\r\n * @returns The translations object for the specified locale.\r\n */\r\nexport const useLittera = <T, K extends keyof T>(\r\n  translations: LitteraTranslations<T>,\r\n  locale?: string\r\n): LitteraTranslated<T, K> => {\r\n  const service = React.useContext(LitteraContext)\r\n  const currentLocale = locale ?? service.locale\r\n\r\n  React.useEffect(() => {\r\n    if (locale) throwInvalidLocale(service.locales, locale)\r\n  }, [locale])\r\n\r\n  return React.useMemo(\r\n    () => translate<T, K>(translations, currentLocale),\r\n    [currentLocale]\r\n  )\r\n}\r\n\r\nexport const makeTranslations = <T, K extends keyof T>(\r\n  translations: T\r\n): ((locale?: string) => LitteraTranslated<T, K>) => {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    const keys: string[] = []\r\n    Object.keys(translations).forEach((locale) => {\r\n      Object.keys(translations[locale]).forEach((key) => {\r\n        if (!keys.includes(key)) keys.push(key)\r\n      })\r\n\r\n      keys.forEach((key) => {\r\n        // console.warn if key is missing in a locale.\r\n        if (!Object.keys(translations[locale]).includes(key)) {\r\n          console.warn(`${key} is missing in locale ${locale}`)\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  return (locale?: string) => {\r\n    return useLittera<T, K>(translations, locale)\r\n  }\r\n}\r\n\r\ntype LitteraMethodsReturn = {\r\n  readonly locale: string\r\n  readonly locales: string[]\r\n  readonly setLocale: (locale: string) => void\r\n  readonly translate: <T, K extends keyof T>(\r\n    translations: LitteraTranslations<T>,\r\n    locale?: string\r\n  ) => LitteraTranslated<T, K>\r\n}\r\n\r\n/**\r\n * @description React hook exposing methods for current context.\r\n * @category React\r\n */\r\nexport const useLitteraMethods = () => {\r\n  const { setLocale, locale, locales } = React.useContext(LitteraContext)\r\n\r\n  const handleLocaleChange = React.useCallback(\r\n    (nextLocale: string) => {\r\n      throwInvalidLocale(locales, nextLocale)\r\n\r\n      setLocale(nextLocale)\r\n    },\r\n    [setLocale]\r\n  )\r\n\r\n  const translateFn = <T, K extends keyof T>(\r\n    translations: LitteraTranslations<T>,\r\n    l?: string\r\n  ) => {\r\n    const currentLocale = l ?? locale ?? locales[0]\r\n\r\n    return translate<T, K>(translations, currentLocale)\r\n  }\r\n\r\n  return React.useMemo<LitteraMethodsReturn>(\r\n    () => ({\r\n      setLocale: handleLocaleChange,\r\n      locale,\r\n      locales,\r\n      translate: translateFn\r\n    }),\r\n    [locale]\r\n  )\r\n}\r\n"],"names":["translate","translations","locale","LitteraContext","React","locales","setLocale","LitteraService","children","initialLocale","Provider","value","throwInvalidLocale","includes","Error","join","useLittera","service","currentLocale","makeTranslations","process","env","NODE_ENV","keys","Object","forEach","key","push","console","warn","useLitteraMethods","handleLocaleChange","nextLocale","translateFn","l"],"mappings":";;IAQaA,SAAS,GAAG,SAAZA,SAAY,CACvBC,YADuB,EAEvBC,MAFuB;AAAA;;AAAA,iCAGKD,YAAY,CAACC,MAAD,CAHjB,mCAG6B,EAH7B;AAAA;;ACJlB,IAAMC,cAAc,GAAGC,mBAAA,CAA8C;AAC1EF,EAAAA,MAAM,EAAE,OADkE;AAE1EG,EAAAA,OAAO,EAAE,CAAC,OAAD,CAFiE;AAG1EC,EAAAA,SAAS,EAAE,uBAH+D;AAI1EN,EAAAA,SAAS,EAAE,qBACTC,YADS,EAETC,MAFS;AAAA,WAGNF,SAAS,CAAOC,YAAP,EAAqBC,MAArB,WAAqBA,MAArB,GAA+B,OAA/B,CAHH;AAAA;AAJ+D,CAA9C,CAAvB;AA2BP,IAAaK,cAAc,GAAG,SAAjBA,cAAiB;;;MAC5BC,gBAAAA;MACAC,qBAAAA;MACAJ,eAAAA;;AAMA,wBAA4BD,cAAA,UAC1BK,aAD0B,WAC1BA,aAD0B,GACTJ,OAAO,CAAC,CAAD,CADE,oBACK,OADL,CAA5B;AAAA,MAAOH,MAAP;AAAA,MAAeI,SAAf;;AAIA,SACEF,mBAAA,CAACD,cAAc,CAACO,QAAhB;AACEC,IAAAA,KAAK,EAAE;AAAET,MAAAA,MAAM,EAANA,MAAF;AAAUI,MAAAA,SAAS,EAATA,SAAV;AAAqBD,MAAAA,OAAO,EAAPA;AAArB;GADT,EAGGG,QAHH,CADF;AAOD,CApBM;;ACzBA,IAAMI,kBAAkB,GAAG,SAArBA,kBAAqB,CAACP,OAAD,EAAoBH,MAApB;AAChC,MAAG,CAACG,OAAO,CAACQ,QAAR,CAAiBX,MAAjB,CAAJ,EACE,MAAM,IAAIY,KAAJ,yCAAgDT,OAAO,CAACU,IAAR,CAAa,IAAb,CAAhD,eAA4Eb,MAA5E,CAAN;AAEF,SAAO,IAAP;AACD,CALM;;ICOMc,UAAU,GAAG,SAAbA,UAAa,CACxBf,YADwB,EAExBC,MAFwB;AAIxB,MAAMe,OAAO,GAAGb,gBAAA,CAAiBD,cAAjB,CAAhB;AACA,MAAMe,aAAa,GAAGhB,MAAH,WAAGA,MAAH,GAAae,OAAO,CAACf,MAAxC;AAEAE,EAAAA,eAAA,CAAgB;AACd,QAAIF,MAAJ,EAAYU,kBAAkB,CAACK,OAAO,CAACZ,OAAT,EAAkBH,MAAlB,CAAlB;AACb,GAFD,EAEG,CAACA,MAAD,CAFH;AAIA,SAAOE,aAAA,CACL;AAAA,WAAMJ,SAAS,CAAOC,YAAP,EAAqBiB,aAArB,CAAf;AAAA,GADK,EAEL,CAACA,aAAD,CAFK,CAAP;AAID,CAfM;AAiBP,IAAaC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC9BlB,YAD8B;AAG9B,MAAImB,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzC,QAAMC,IAAI,GAAa,EAAvB;AACAC,IAAAA,MAAM,CAACD,IAAP,CAAYtB,YAAZ,EAA0BwB,OAA1B,CAAkC,UAACvB,MAAD;AAChCsB,MAAAA,MAAM,CAACD,IAAP,CAAYtB,YAAY,CAACC,MAAD,CAAxB,EAAkCuB,OAAlC,CAA0C,UAACC,GAAD;AACxC,YAAI,CAACH,IAAI,CAACV,QAAL,CAAca,GAAd,CAAL,EAAyBH,IAAI,CAACI,IAAL,CAAUD,GAAV;AAC1B,OAFD;AAIAH,MAAAA,IAAI,CAACE,OAAL,CAAa,UAACC,GAAD;AAEX,YAAI,CAACF,MAAM,CAACD,IAAP,CAAYtB,YAAY,CAACC,MAAD,CAAxB,EAAkCW,QAAlC,CAA2Ca,GAA3C,CAAL,EAAsD;AACpDE,UAAAA,OAAO,CAACC,IAAR,CAAgBH,GAAhB,8BAA4CxB,MAA5C;AACD;AACF,OALD;AAMD,KAXD;AAYD;;AAED,SAAO,UAACA,MAAD;AACL,WAAOc,UAAU,CAAOf,YAAP,EAAqBC,MAArB,CAAjB;AACD,GAFD;AAGD,CAtBM;AAsCP,IAAa4B,iBAAiB,GAAG,SAApBA,iBAAoB;AAC/B,0BAAuC1B,gBAAA,CAAiBD,cAAjB,CAAvC;AAAA,MAAQG,SAAR,qBAAQA,SAAR;AAAA,MAAmBJ,MAAnB,qBAAmBA,MAAnB;AAAA,MAA2BG,OAA3B,qBAA2BA,OAA3B;;AAEA,MAAM0B,kBAAkB,GAAG3B,iBAAA,CACzB,UAAC4B,UAAD;AACEpB,IAAAA,kBAAkB,CAACP,OAAD,EAAU2B,UAAV,CAAlB;AAEA1B,IAAAA,SAAS,CAAC0B,UAAD,CAAT;AACD,GALwB,EAMzB,CAAC1B,SAAD,CANyB,CAA3B;;AASA,MAAM2B,WAAW,GAAG,SAAdA,WAAc,CAClBhC,YADkB,EAElBiC,CAFkB;;;AAIlB,QAAMhB,aAAa,WAAGgB,CAAH,WAAGA,CAAH,GAAQhC,MAAR,mBAAkBG,OAAO,CAAC,CAAD,CAA5C;AAEA,WAAOL,SAAS,CAAOC,YAAP,EAAqBiB,aAArB,CAAhB;AACD,GAPD;;AASA,SAAOd,aAAA,CACL;AAAA,WAAO;AACLE,MAAAA,SAAS,EAAEyB,kBADN;AAEL7B,MAAAA,MAAM,EAANA,MAFK;AAGLG,MAAAA,OAAO,EAAPA,OAHK;AAILL,MAAAA,SAAS,EAAEiC;AAJN,KAAP;AAAA,GADK,EAOL,CAAC/B,MAAD,CAPK,CAAP;AASD,CA9BM;;;;;;;;"}